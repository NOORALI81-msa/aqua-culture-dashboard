{% extends 'layout.html' %}
{% block title %}Sales{% endblock %}
{% block content %}
<div class="content-block">
    <h2>Record a Sale</h2>
    <p>Log a new product sale to a farmer.</p>
</div>

<!-- Record Sale Form -->
<div class="content-block">
    <h3>New Sale Details</h3>
    <form action="{{ url_for('sales') }}" method="post" class="styled-form">
        <select name="farmer_id" required>
            <option value="" disabled selected>-- Select a Farmer --</option>
            {% for farmer in farmers %}
            <option value="{{ farmer.id }}">{{ farmer.farmer_name }}</option>
            {% endfor %}
        </select>
        <input type="text" name="product_name" placeholder="Product Name (e.g., Drug A)" required>
        <input type="number" name="quantity_sold" placeholder="Quantity Sold" required>
        <textarea name="prescription" placeholder="Prescription / Notes"></textarea>
        <input type="submit" value="Record Sale">
        {% if msg %}
        <p class="msg">{{ msg }}</p>
        {% endif %}
    </form>
</div>

<!-- Recent Sales List -->
<div class="content-block">
    <h3>Your Recent Sales</h3>
    <table class="styled-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Farmer</th>
                <th>Product</th>
                <th>Quantity</th>
            </tr>
        </thead>
        <tbody>
            {% for sale in recent_sales %}
            <tr>
                <td>{{ sale.sale_date.strftime('%Y-%m-%d') }}</td>
                <td>{{ sale.farmer_name }}</td>
                <td>{{ sale.product_name }}</td>
                <td>{{ sale.quantity_sold }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
